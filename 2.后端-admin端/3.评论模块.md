# ä¸€ã€ğŸŒåŠ è½½è¯„è®ºåˆ—è¡¨æ¥å£

## 1.1 æ¥å£æè¿°

è¿”å›æ‰€æœ‰è¯„è®ºï¼ŒæŒ‰æ¡ä»¶æŸ¥è¯¢ã€‚

## 1.2 è¯·æ±‚åœ°å€

```http
GET /admin/comment
```

## 1.3 è¯·æ±‚å‚æ•°

| å‚æ•°å        | å‚æ•°ç±»å‹ | æ˜¯å¦å¿…å¡« | è¯´æ˜                            |
| ------------- | -------- | -------- | ------------------------------- |
| page          | `int`    | `true`   | é¡µç                             |
| pageSize      | `int`    | `true`   | æ¯é¡µæ¡ç›®                        |
| levelType     | `int`    | `false`  | 0: 1çº§è¯„è®º, 1: 2çº§è¯„è®º          |
| status        | `int`    | `false`  | 0: å·²åˆ é™¤, 1: å¾…å®¡æ ¸, 2: å·²å®¡æ ¸ |
| startPostTime | `date`   | `false`  | å¼€å§‹å‘å¸ƒæ—¶é—´                    |
| endPostTime   | `date`   | `false`  | ç»“æŸå‘å¸ƒæ—¶é—´                    |

## 1.4 å“åº”ç¤ºä¾‹

```json
{
    "status": "success",
    "code": 200,
    "msg": "è¯·æ±‚æˆåŠŸ",
    "data": {
        "total": 76,
        "page": 1,
        "pageSize": 10,
        "pageTotal": 8,
        "rows": [
            {
                "commentId": 105,
                "pCommentId": 100,
                "articleId": "000981283431340",
                "imgPath": null,
                "content": "ä½œè€…å›å¤ä½ çš„1çº§è¯„è®º",
                "senderAvatar": null,
                "senderId": "9876175182",
                "senderNickname": "user_189",
                "senderIpAddress": "å››å·çœ",
                "receiverId": null,
                "receiverNickname": null,
                "likeCount": 0,
                "topType": 0,
                "status": 2,
                "postTime": "2025-04-05 14:57:42",
                "doLike": null,
                "subComment": null
            },
            ......
    }
}
```

## 1.5 æ¥å£å®ç°

åœ¨æ§åˆ¶å™¨ä¸­å®šä¹‰æ–¹æ³•`loadComments()`ï¼š

```java
/**
     * åŠ è½½è¯„è®ºåˆ—è¡¨æ¥å£
     *
     * @param page
     * @param pageSize
     * @param levelType
     * @param status
     * @param startPostTime
     * @param endPostTime
     * @return
     */
    @GetMapping
    @AccessControl
    public Result<PageBean<CommentVo>> loadComments(@Validation(min = 1) Integer page,
                                                    @Validation Integer pageSize,
                                                    @Validation(max = 1, required = false) Integer levelType,
                                                    @Validation(max = 2, required = false) Integer status,
                                                    @DateTimeFormat(pattern = "yyyy-MM-dd") LocalDate startPostTime,
                                                    @DateTimeFormat(pattern = "yyyy-MM-dd") LocalDate endPostTime) {
        CommentQuery commentQuery = new CommentQuery();
        commentQuery.setPage(page);
        commentQuery.setPageSize(pageSize);
        commentQuery.setLevelType(levelType);
        commentQuery.setStatus(status);
        commentQuery.setStartPostTime(startPostTime);
        commentQuery.setEndPostTime(endPostTime);
        commentQuery.setOrderBy("post_time desc");	// é»˜è®¤å‘å¸ƒæ—¶é—´å€’åºæ’åº

        PageBean<CommentVo> commentVo = commentService.findByCondition(commentQuery);
        return Result.success(commentVo);
    }
```

è°ƒç”¨ä¸šåŠ¡å±‚æ¡ä»¶æŸ¥è¯¢æ–¹æ³•ã€‚

`CommentQuery`ä¸­æ·»åŠ ä¸€ä¸ª`levelType`å±æ€§ï¼Œæ§åˆ¶è¯„è®ºç­‰çº§ï¼ŒåŒæ—¶æŸ¥è¯¢SQLå¢åŠ æ­¤æ¡ä»¶ï¼š

```xml
<!-- 1çº§è¯„è®º -->
<if test="levelType != null and levelType == 0">
    and p_comment_id = 0
</if>
<!-- 2çº§è¯„è®º -->
<if test="levelType != null and levelType == 1">
    and p_comment_id != 0
</if>
```



# äºŒã€ğŸŒåŠ è½½1çº§è¯„è®ºæ¥å£

## 2.1 æ¥å£æè¿°

ç®¡ç†ç«¯æŸ¥çœ‹æ–‡ç« æ—¶å¯é€šè¿‡æ­¤æ¥å£æŸ¥çœ‹å¯¹åº”1çº§è¯„è®ºã€‚

## 2.2 è¯·æ±‚åœ°å€

```http
GET /admin/comment/{article-id}/l1
```

## 2.3 è¯·æ±‚å‚æ•°

| å‚æ•°å    | å‚æ•°ç±»å‹ | æ˜¯å¦å¿…å¡« | è¯´æ˜   |
| --------- | -------- | -------- | ------ |
| articleId | `string` | `true`   | æ–‡ç« id |
| page      | `int`    | `true`   | é¡µç    |

## 2.4 å“åº”ç¤ºä¾‹

```json
{
    "status": "success",
    "code": 200,
    "msg": "è¯·æ±‚æˆåŠŸ",
    "data": {
        "total": 6,
        "page": 1,
        "pageSize": 10,
        "pageTotal": 1,
        "rows": [
            {
                "commentId": 83,
                "pCommentId": 0,
                "articleId": "ababa",
                "imgPath": null,
                "content": "æ„Ÿè§‰é…è‰²ä¸å¦‚ä¸Šä¸€ä»£å¥½çœ‹",
                "senderAvatar": null,
                "senderId": "9876175182",
                "senderNickname": "user_189",
                "senderIpAddress": "å››å·çœ",
                "receiverId": null,
                "receiverNickname": null,
                "likeCount": 0,
                "topType": 0,
                "status": 2,
                "postTime": "2025-02-21 09:59:02",
                "doLike": null,
                "subComment": {
                    "total": 3,
                    "page": 1,
                    "pageSize": 10,
                    "pageTotal": 1,
                    "rows": [
                        {
                            "commentId": 86,
                            "pCommentId": 83,
                            "articleId": "ababa",
                            "imgPath": null,
                            "content": "é…è‰²éƒ½æ˜¯å…¶æ¬¡ï¼Œå…³é”®æ˜¯è¦æ€§èƒ½",
                            "senderAvatar": null,
                            "senderId": "9876175182",
                            "senderNickname": "user_189",
                            "senderIpAddress": "å››å·çœ",
                            "receiverId": "9619980088",
                            "receiverNickname": "ling",
                            "likeCount": 0,
                            "topType": 0,
                            "status": 2,
                            "postTime": "2025-02-21 10:17:40",
                            "doLike": null,
                            "subComment": null
                        },
                        ......
                    ]
                }
            },
            ......
        ]
    }
}
```

## 2.5 æ¥å£å®ç°

å…¶å®å°±æ˜¯webç«¯æŸ¥çœ‹è¯„è®ºçš„é€»è¾‘ï¼Œ1çº§è¯„è®ºåˆ†é¡µå±•ç¤ºï¼Œ2çº§è¯„è®ºé»˜è®¤å±•ç¤ºå‰10æ¡ã€‚åªæ˜¯ç®¡ç†çš„æŸ¥è¯¢çš„æ˜¯æ‰€æœ‰è¯„è®ºï¼Œå› æ­¤ä¸éœ€è¦`statusControl`æ¥æ§åˆ¶ã€‚

åœ¨æ§åˆ¶å™¨ä¸­æ·»åŠ æ–¹æ³•`loadL1Comments()`ï¼Œè°ƒç”¨ä¸šåŠ¡å±‚æŸ¥è¯¢æ–¹æ³•ï¼š

```java
/**
     * åŠ è½½1çº§è¯„è®ºæ ‘æ¥å£
     *
     * @param articleId
     * @param page
     * @return
     */
    @GetMapping("/{article-id}/l1")
    @AccessControl
    public Result<PageBean<CommentVo>> loadL1Comments(@PathVariable("article-id") @Validation(max = 15) String articleId,
                                                      @Validation(min = 1) Integer page) {
        CommentQuery commentQueryDto = new CommentQuery();
        commentQueryDto.setpCommentId(Constant.NUM_0);
        commentQueryDto.setArticleId(articleId);
        commentQueryDto.setPage(page);
        commentQueryDto.setPageSize(PageSizeEnum.SIZE_10.getPageSize());    // å›ºå®šæ¯é¡µ10æ¡ç›®
        commentQueryDto.setOrderBy(CommentOrderEnum.NEW.getOrderBy());  // é»˜è®¤æœ€æ–°æ’åº

        PageBean<CommentVo> commentVo = commentService.findLeve1andLeve2Top10(commentQueryDto);

        return Result.success(commentVo);
    }
```



# ä¸‰ã€ğŸŒåŠ è½½2çº§è¯„è®ºæ¥å£

## 3.1 æ¥å£æè¿°

ç®¡ç†ç«¯æŸ¥çœ‹æ–‡ç« æ—¶å¯é€šè¿‡æ­¤æ¥å£æŸ¥çœ‹å¯¹åº”2çº§è¯„è®ºã€‚

## 3.2 è¯·æ±‚åœ°å€

```http
GET /admin/comment/{article-id}/l2
```

## 3.3 è¯·æ±‚å‚æ•°

| å‚æ•°å     | å‚æ•°ç±»å‹ | æ˜¯å¦å¿…å¡« | è¯´æ˜     |
| ---------- | -------- | -------- | -------- |
| articleId  | `string` | `true`   | æ–‡ç« id   |
| page       | `int`    | `true`   | é¡µç      |
| pCommentId | `int`    | `true`   | çˆ¶è¯„è®ºid |

## 3.4 å“åº”ç¤ºä¾‹

```json
{
    "status": "success",
    "code": 200,
    "msg": "è¯·æ±‚æˆåŠŸ",
    "data": {
        "total": 4,
        "page": 1,
        "pageSize": 10,
        "pageTotal": 1,
        "rows": [
            {
                "commentId": 80,
                "pCommentId": 4,
                "articleId": "uukicbc29eqo",
                "imgPath": null,
                "content": "å›å¤2çº§è¯„è®º",
                "senderAvatar": "avatar/2025-04/aa21ac441ca44890932c9d987a3d060e.jpg",
                "senderId": "9619980088",
                "senderNickname": "ling",
                "senderIpAddress": "å››å·çœ",
                "receiverId": "7878970085",
                "receiverNickname": "user_aliyun",
                "likeCount": 0,
                "topType": 0,
                "status": 2,
                "postTime": "2025-02-20 23:07:38",
                "doLike": null,
                "subComment": null
            },
            ......
        ]
    }
}
```

## 3.5 æ¥å£å®ç°

æ„é€ æŸ¥è¯¢å‚æ•°ï¼Œè°ƒç”¨2çº§è¯„è®ºæŸ¥è¯¢æ–¹æ³•å³å¯ã€‚

åœ¨`CommonteController`ä¸­æ·»åŠ æ¥å£`loadL2Comments`ï¼š

```java
/**
     * åŠ è½½2çº§è¯„è®ºåˆ—è¡¨æ¥å£
     *
     * @param articleId
     * @param pCommentId
     * @param page
     * @return
     */
    @GetMapping("/{article-id}/l2")
    @AccessControl(loginRequired = true)
    public Result<PageBean<CommentVo>> loadL2Comments(@PathVariable("article-id") @Validation(max = 15) String articleId,
                                                      @Validation(min = 1) Integer pCommentId,
                                                      @Validation(min = 1) Integer page) {
        CommentQuery commentQueryDto = new CommentQuery();
        commentQueryDto.setArticleId(articleId);
        commentQueryDto.setpCommentId(pCommentId);
        commentQueryDto.setPage(page);
        commentQueryDto.setOrderBy(CommentOrderEnum.HOT.getOrderBy());      // é»˜è®¤æœ€çƒ­æ’åº
        commentQueryDto.setPageSize(PageSizeEnum.SIZE_10.getPageSize());    // å›ºå®šæ¯é¡µ10æ¡ç›®

        PageBean<CommentVo> level2Comments = commentService.findL2Comment(commentQueryDto);

        return Result.success(level2Comments);
    }
```

é»˜è®¤æŒ‰ç…§æœ€çƒ­æ’åºï¼Œæ¯é¡µå›ºå®š10æ¡ã€‚



# å››ã€ğŸŒè¯„è®ºå®¡æ ¸æ¥å£

## 4.1 æ¥å£æè¿°

ç®¡ç†å‘˜å®¡æ ¸è¯„è®ºçš„æ¥å£ã€‚å®¡æ ¸é€šè¿‡åï¼Œä¼šæ›´æ–°ç”¨æˆ·ç§¯åˆ†ã€æ–‡ç« è¯„è®ºæ•°é‡ï¼Œå¹¶è®°å½•æ¶ˆæ¯ã€æ¨é€é€šçŸ¥ã€‚æ”¯æŒæ‰¹é‡å®¡æ ¸ã€‚

## 4.2 è¯·æ±‚åœ°å€

```http
PUT /admin/comment/{ids}
```

## 4.3 è¯·æ±‚å‚æ•°

| å‚æ•°å | å‚æ•°ç±»å‹     | æ˜¯å¦å¿…å¡« | è¯´æ˜       |
| ------ | ------------ | -------- | ---------- |
| ids    | `array<int>` | `true`   | è¯„è®ºIDé›†åˆ |

## 4.4 å“åº”ç¤ºä¾‹

```json
{
    "status": "success",
    "code": 200,
    "msg": "è¯·æ±‚æˆåŠŸ",
    "data": null
}
```

## 4.5 æ¥å£å®ç°

è¯„è®ºå®¡æ ¸çš„æ ¸å¿ƒé€»è¾‘åœ¨å‘å¸ƒè¯„è®ºæ—¶å·²å®ç°ï¼Œå½“è¯„è®ºå®¡æ ¸å¼€å…³å…³é—­æ—¶ï¼Œè¯„è®ºç›´æ¥å®¡æ ¸é€šè¿‡ã€‚æœ¬æ¥å£å¤ç”¨å®¡æ ¸é€»è¾‘ï¼Œä¸åŒç‚¹åœ¨äº**æ”¯æŒæ‰¹é‡å®¡æ ¸**ï¼Œéœ€è¦å¯¹å¤šä¸ªè¯„è®ºåŒæ—¶è¿›è¡Œå¤„ç†ã€‚

ä»¥ä¸‹æä¾›ä¸¤ç§å®ç°æ–¹å¼ï¼š

### 4.5.1 å®ç°1

é€šè¿‡éå†idé›†åˆï¼Œä¾æ¬¡å¯¹æ¯ä¸ªè¯„è®ºè¿›è¡Œå®¡æ ¸å¤„ç†ã€‚

åœ¨`CommentController`ä¸­å®šä¹‰æ¥å£`auditComments`ï¼š

```java
/**
     * æ‰¹é‡å®¡æ ¸è¯„è®ºæ¥å£
     *
     * @param ids
     * @return
     */
    @PutMapping("/{ids}")
    @AccessControl(loginRequired = true)
    public Result<Void> auditComments(@PathVariable @Validation List<Integer> ids) {
        commentService.auditComments(ids);
        return Result.success();
    }
```

è°ƒç”¨ä¸šåŠ¡å±‚`auditCommets()`ï¼Œä¸šåŠ¡å±‚å®šä¹‰æ–¹æ³•ï¼š

```java
/**
     * å®¡æ ¸è¯„è®º
     *
     * @param ids
     */
    void auditComments(List<Integer> ids);
```

å®ç°ï¼š

```java
@Override
public void auditComments(List<Integer> ids) {
    ids.forEach(commentTxService::auditComment);
}
```

è¿™é‡Œå¤„ç†é€»è¾‘åŒæ–‡ç« å®¡æ ¸ï¼Œéƒ½æ˜¯éå†ç„¶åé€ä¸ªè¿›è¡Œå®¡æ ¸ï¼Œå®¡æ ¸é€»è¾‘å§”æ‰˜ç»™äº‹åŠ¡ä»£ç†ç±»`CommentTxService`ï¼Œä»£ç†ç±»çš„ä½œç”¨æ˜¯ä¿è¯äº‹åŠ¡ç”Ÿæ•ˆï¼Œ`CommentTxService`å¦‚ä¸‹ï¼š

```java
@Service
public class CommentTxService {
    private static final Logger log = LoggerFactory.getLogger(CommentService.class);
    @Resource
    private CommentMapper commentMapper;
    @Resource
    private ArticleMapper articleMapper;
    @Resource
    private UserPointsRecordService userPointsRecordService;
    @Resource
    private UserMessageMapper userMessageMapper;
    @Resource
    private UserMessageService userMessageService;

    /**
     * å®¡æ ¸è¯„è®º
     *
     * @param id
     */
    @Transactional(rollbackFor = Exception.class)
    public void auditComment(Integer id) {
        // æŸ¥è¯¢è¯„è®ºæ˜¯å¦å­˜åœ¨
        Comment comment = commentMapper.selectById(id);
        if (Objects.isNull(comment))
            throw new BusinessException(CommonMsg.COMMENT_NOT_EXISTS);

        // ä¸æ˜¯å¾…å®¡æ ¸çŠ¶æ€çš„è¯„è®ºï¼Œè¿‡æ»¤æ‰
        Integer status = comment.getStatus();
        if (Objects.equals(status, TargetStatusEnum.AUDITED.getStatus())) return;
        // åˆ é™¤çš„è¯„è®ºä¸èƒ½å®¡æ ¸
        if (Objects.equals(status, TargetStatusEnum.DELETED.getStatus()))
            throw new BusinessException(CommonMsg.UNABLE_AUDIT_DELETE_COMMENT);

        Integer pid = comment.getpCommentId();
        boolean isL1 = Objects.equals(pid, Constant.NUM_0);     // æ˜¯å¦1çº§è¯„è®º

        // 1çº§ç›´æ¥å®¡æ ¸ 2çº§å…ˆåˆ¤æ–­1çº§æ˜¯å¦å®¡æ ¸
        Comment pcd = commentMapper.selectById(pid);    // çˆ¶çº§è¯„è®º
        if (!isL1 && Objects.equals(pcd.getStatus(), TargetStatusEnum.PENDING.getStatus())) {
            throw new BusinessException(String.format(CommonMsg.AUDIT_FIRST_LEVEL1, pid));
        }

        Comment editComment = new Comment();
        editComment.setCommentId(id);
        editComment.setStatus(TargetStatusEnum.AUDITED.getStatus());
        commentMapper.update(editComment);  // å®¡æ ¸

        // æ›´æ–°ç§¯åˆ†
        Integer commentPoints = SysCacheUtil.getSysSettingManager().getSysSetting4Comment().getCommentPoints();
        userPointsRecordService.processUserPoints(comment.getSenderId(), OperationTypeEnum.POST_COMMENT.getType(), commentPoints);
        // æ›´æ–°æ–‡ç« è¯„è®ºæ•°
        articleMapper.updateCommentCount(comment.getArticleId(), Constant.NUM_1);


        String articleId = comment.getArticleId();
        Article article = articleMapper.selectById(articleId);

        // ç¡®è®¤è¯„è®ºå›å¤æ–¹å’Œè¯„è®ºå‘é€æ–¹
        String receiver = isL1 ? article.getUserId() :
                comment.getReceiverId() == null ? pcd.getSenderId() : comment.getReceiverId();
        String sender = comment.getSenderId();
        // ä¸ä¸€æ ·æ‰å‘æ¶ˆæ¯
        if (!Objects.equals(sender, receiver)) {
            UserMessage userMessage = new UserMessage();
            userMessage.setReceivedUserId(receiver);
            userMessage.setArticleId(articleId);
            userMessage.setArticleTitle(article.getTitle());
            userMessage.setCommentId(id);
            userMessage.setSenderAvatar(comment.getSenderAvatar());
            userMessage.setSendUserId(comment.getSenderId());
            userMessage.setSendNickName(comment.getSenderNickname());
            userMessage.setMessageType(MessageTypeEnum.COMMENT.getType());
            userMessage.setMessageContent(isL1 ? Constant.ARTICLE_COMMENT_MESSAGE_CONTENT : Constant.BACK_COMMENT_MESSAGE_CONTENT);
            userMessage.setStatus(MessageStatusEnum.NO_READ.getStatus());
            Date date = new Date();
            userMessage.setCreateTime(date);
            userMessage.setUpdateTime(date);
            userMessageMapper.insert(userMessage);  // è®°å½•æ¶ˆæ¯

            userMessageService.requestPushNotice(receiver); // è¯·æ±‚webç«¯é€šçŸ¥ç”¨æˆ·
        }
    }
}
```

ç¡®è®¤å›å¤äººé€»è¾‘ï¼š

- å¦‚æœå½“å‰è¯„è®º == 1çº§è¯„è®ºï¼Œé‚£ä¹ˆå›å¤çš„æ˜¯æ–‡ç« ï¼Œå›å¤äºº == æ–‡ç« ä½œè€…ã€‚
- å¦‚æœå½“å‰è¯„è®º == 2çº§è¯„è®º && å½“å‰è¯„è®ºæ²¡æœ‰å›å¤äººï¼Œå›å¤äºº == 1çº§è¯„è®ºä½œè€…ã€‚
- å¦‚æœå½“å‰è¯„è®º == 2çº§è¯„è®º && å½“å‰è¯„è®ºæœ‰å›å¤äººï¼Œå›å¤äºº == å½“å‰è¯„è®ºå›å¤äººã€‚

ä¸è¿‡è¿™æ ·çš„ä»£ç ç»“æ„å¸¦æ¥ä¸€ä¸ªæ‰§è¡Œæ€§èƒ½çš„é—®é¢˜ï¼š**æ‰¹é‡å®¡æ ¸å¾ˆå¤šè¯„è®º**çš„æ—¶å€™**æ¯ä¸ªidéƒ½æ˜¯ä¸€æ¬¡æ•°æ®åº“æŸ¥è¯¢+æ›´æ–°+æ¨é€é€šçŸ¥**ï¼Œä¸²è¡Œæ‰§è¡Œï¼Œæ•ˆç‡å¾ˆä½ã€‚

äºæ˜¯æ˜¯å¼•å‡ºäº†ç¬¬2ç§å®ç°æ–¹æ³•ã€‚

### 4.5.2 å®ç°2

ç¬¬2ç§æ–¹æ³•çš„ä¼˜åŒ–ç‚¹ï¼š

- **æ‰¹é‡æŸ¥è¯¢** è¯„è®ºï¼Œä¸ä¸€ä¸ªä¸€ä¸ªæŸ¥ã€‚
- **æ‰¹é‡æ›´æ–°** çŠ¶æ€ï¼ˆå®¡æ ¸é€šè¿‡ï¼‰ï¼Œè€Œä¸æ˜¯å•æ¡updateã€‚
- **åªæ¨é€éœ€è¦æ¨é€çš„æ¶ˆæ¯**ã€‚
- **æ•´ä¸ªäº‹åŠ¡** åŒ…èµ·æ¥ï¼Œå‡ºé”™ç»Ÿä¸€å›æ»šã€‚

å…¶ä»–çš„ä»£ç ä¸å˜ï¼Œåœ¨ä¸šåŠ¡å±‚é‡å†™`auditComments()`ï¼š

```java
/**
     * æ‰¹é‡å®¡æ ¸è¯„è®º
     * @param ids
     */
    @Override
    @Transactional(rollbackFor = Exception.class)
    public void auditComments(List<Integer> ids) {
        // è‹¥idé›†ä¸ºç©ºï¼Œä¸å¤„ç†
        if (CollectionUtils.isEmpty(ids)) {
            return;
        }

        List<Comment> comments = findByIds(ids);    //æ‰¹é‡idæŸ¥è¯¢
		
        // è‹¥æŸ¥è¯¢é›†ä¸ºç©ºï¼Œä¸å¤„ç†
        if (CollectionUtils.isEmpty(comments)) {
            return;
        }

        // é¢„å¤„ç†ï¼Œç­›é€‰å‡ºæœªå®¡æ ¸è¯„è®º
        List<Comment> toAuditComments = comments.stream().filter(comment -> {
            Integer status = comment.getStatus();
            // åˆ é™¤çš„è¯„è®ºä¸èƒ½å®¡æ ¸ï¼ŒæŠ›å¼‚å¸¸
            if (status.equals(TargetStatusEnum.DELETED.getStatus())) {
                throw new BusinessException(CommonMsg.UNABLE_AUDIT_DELETE_ARTICLE);
            }
            return !status.equals(TargetStatusEnum.AUDITED.getStatus());
        }).collect(Collectors.toList());
		
        // ç­›é€‰åè¯„è®ºé›†ä¸ºç©ºï¼Œä¸å¤„ç†
        if (CollectionUtils.isEmpty(toAuditComments)) {
            return;
        }

        // æ‰¹é‡å®¡æ ¸è¯„è®º
        batchEditStatus(toAuditComments.stream()
                        .map(Comment::getCommentId)
                        .collect(Collectors.toList()),
                TargetStatusEnum.AUDITED.getStatus());

        Integer points = SysCacheUtil.getSysSettingManager().getSysSetting4Comment().getCommentPoints();    // ç§¯åˆ†
        // åŠ ç§¯åˆ†ã€æ›´æ–°è¯„è®ºæ•°ã€é€šçŸ¥æ¶ˆæ¯
        toAuditComments.forEach(comment -> {
            userPointsRecordService.processUserPoints(comment.getSenderId(), OperationTypeEnum.POST_COMMENT.getType(), points);
            articleMapper.updateCommentCount(comment.getArticleId(), Constant.NUM_1);
            // è®°å½•æ¶ˆæ¯å¹¶é€šçŸ¥
            recordAndNotify(comment);
        });
    }

    /**
     * è®°å½•æ¶ˆæ¯å¹¶é€šçŸ¥
     * @param comment
     */
    private void recordAndNotify(Comment comment) {
        String articleId = comment.getArticleId();
        Article article = articleMapper.selectById(articleId);
        if (article == null) {
            return;
        }

        Integer pid = comment.getpCommentId();
        log.info("çˆ¶è¯„è®ºidï¼š{}", pid);
        boolean isL1 = pid.equals(0);
        // å¾—åˆ°æ¥æ”¶äºº
        String receiver = isL1 ? article.getUserId() :
                Optional.ofNullable(comment.getReceiverId()).orElseGet(() -> {
                    Comment pComment = findById(pid);
                    return pComment == null ? null : pComment.getSenderId();
                });

        if (receiver != null && !receiver.equals(comment.getSenderId())) {
            // è®°å½•æ¶ˆæ¯
            UserMessage userMessage = new UserMessage();
            userMessage.setReceivedUserId(receiver);
            userMessage.setArticleId(articleId);
            userMessage.setArticleTitle(article.getTitle());
            userMessage.setCommentId(isL1 ? pid : comment.getpCommentId());
            userMessage.setSenderAvatar(comment.getSenderAvatar());
            userMessage.setSendUserId(comment.getSenderId());
            userMessage.setSendNickName(comment.getSenderNickname());
            userMessage.setMessageType(MessageTypeEnum.COMMENT.getType());
            String content = isL1 ? Constant.ARTICLE_COMMENT_MESSAGE_CONTENT : Constant.BACK_COMMENT_MESSAGE_CONTENT;
            userMessage.setMessageContent(content);
            userMessage.setStatus(MessageStatusEnum.NO_READ.getStatus());
            Date date = new Date();
            userMessage.setCreateTime(date);
            userMessage.setUpdateTime(date);
            userMessageService.add(userMessage);

            userMessageService.requestPushNotice(receiver); // è¯·æ±‚webç«¯é€šçŸ¥ç”¨æˆ·
        }
    }
```

ä¸å†æ˜¯ä¸€ä¸ªä¸€ä¸ªidå»å¤„ç†ï¼Œè€Œæ˜¯æ‰¹é‡æŸ¥è¯¢å‡ºå¾…å®¡æ ¸çš„è¯„è®ºï¼Œç„¶åå†æ‰¹é‡æ›´æ–°è¯„è®ºçš„å®¡æ ¸çŠ¶æ€ã€‚æœ€åå†å»å¤„ç†ç§¯åˆ†ã€è¯„è®ºæ•°åŠæ¶ˆæ¯è®°å½•ä¸æ¨é€ã€‚

### 4.5.3 ç»†èŠ‚

1ã€å®ç°1æ ¡äºå®ç°2ï¼Œè™½ç„¶æ€§èƒ½ä¸Šæœ‰ä¸è¶³ï¼Œä½†å®ƒåœ¨å‡ºç°é”™è¯¯æ—¶åªä¼šå½±å“å‡ºé”™çš„é‚£æ¡è¯„è®ºï¼Œä¸ä¼šå¯¼è‡´æ‰€æœ‰æ“ä½œå›æ»šï¼›å·²ç»å®¡æ ¸é€šè¿‡çš„è¯„è®ºä»å¯æ­£å¸¸ç”Ÿæ•ˆã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå®ç°2é‡‡ç”¨æ•´ä½“äº‹åŠ¡å›æ»šç­–ç•¥ï¼Œä¸€æ—¦æŸä¸ªç¯èŠ‚å‡ºé”™ï¼Œæ‰€æœ‰æ“ä½œéƒ½ä¼šè¢«æ’¤é”€ï¼Œç‰µä¸€å‘åŠ¨å…¨èº«ã€‚

2ã€åœ¨å®ç°2ä¸­ï¼Œæˆ‘åªå¯¹è¯„è®ºçš„æŸ¥è¯¢å’Œå®¡æ ¸æ›´æ–°éƒ¨åˆ†åšäº†æ‰¹é‡å¤„ç†ï¼Œå…¶ä½™å¦‚ç”¨æˆ·ç§¯åˆ†æ›´æ–°ä¸æ–‡ç« è¯„è®ºæ•°é‡æ›´æ–°ä¾ç„¶é‡‡ç”¨é€æ¡éå†çš„æ–¹å¼ã€‚åŸå› å¦‚ä¸‹ï¼š

- **æ‰¹é‡æ›´æ–°é€‚ç”¨äº"å¤šæ¡è®°å½•èµ‹äºˆç›¸åŒå€¼"çš„æƒ…å†µ**ã€‚ä¾‹å¦‚ï¼Œå°†å¤šæ¡è¯„è®ºç»Ÿä¸€æ ‡è®°ä¸º"å·²å®¡æ ¸"æ—¶ï¼Œæ— è®ºè¯„è®ºIDå¦‚ä½•ï¼Œéƒ½å¯é€šè¿‡ä¸€æ¡ SQL ä¸€æ¬¡æ€§æ›´æ–°ã€‚
- **ç§¯åˆ†æ›´æ–°éœ€è®°å½•æ“ä½œæ˜ç»†**ã€‚è™½ç„¶æ¯æ¡è¯„è®ºçš„ç§¯åˆ†å€¼å›ºå®šï¼Œä¹Ÿæ»¡è¶³æ‰¹é‡æ›´æ–°"èµ‹ç›¸åŒå€¼"çš„æ¡ä»¶ï¼Œä½†ç§¯åˆ†æ“ä½œä¸ä»…è¦ä¿®æ”¹ç”¨æˆ·ç§¯åˆ†å­—æ®µï¼Œè¿˜è¦å†™å…¥ç§¯åˆ†å˜åŠ¨è®°å½•ï¼Œéš¾ä»¥åˆå¹¶åˆ°åŒä¸€æ¡ SQLã€‚
- **è¯„è®ºæ•°é‡æ›´æ–°æ›´ä¸ºå¤æ‚**ã€‚ä¸åŒè¯„è®ºå¯¹åº”ä¸åŒæ–‡ç« ï¼Œæ¯ç¯‡æ–‡ç« çš„è¯„è®ºå¢é‡å„å¼‚ï¼Œè‹¥è¦æ‰¹é‡æ›´æ–°ï¼Œå°±éœ€è¦äº‹å…ˆç»Ÿè®¡å‡ºæ¯ç¯‡æ–‡ç« çš„æ–°è¯„è®ºæ€»æ•°ï¼Œå†æ„é€ åŠ¨æ€ SQLï¼Œå¼€å‘å’Œç»´æŠ¤æˆæœ¬è¾ƒé«˜ï¼Œå› æ­¤æš‚æœªåšæ‰¹é‡åŒ–å¤„ç†ã€‚

3ã€å½“å‰æ¶ˆæ¯è®°å½•å’Œæ¨é€é€šçŸ¥å‡ä»¥åŒæ­¥æ–¹å¼æ‰§è¡Œã€‚åç»­å¯è€ƒè™‘ï¼š

- ä½¿ç”¨ **Builder æ¨¡å¼** é‡æ„æ¶ˆæ¯è®°å½•é€»è¾‘ï¼Œæå‡ä»£ç å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ï¼›
- å°†æ¨é€é€šçŸ¥æ”¹ä¸º **å¼‚æ­¥æ‰§è¡Œ**ï¼Œæé«˜ç³»ç»Ÿå“åº”æ€§èƒ½ã€‚



# äº”ã€ğŸŒåˆ é™¤è¯„è®ºæ¥å£

## 5.1 æ¥å£æè¿°

é€»è¾‘åˆ é™¤è¯„è®ºï¼Œæ”¯æŒæ‰¹é‡åˆ é™¤ã€‚åˆ é™¤åå°†åŒæ­¥å‡å°‘å¯¹åº”æ–‡ç« çš„è¯„è®ºæ•°ã€‚

## 5.2 è¯·æ±‚åœ°å€

```http
DELETE /admin/comment/{ids}
```

## 5.3 è¯·æ±‚å‚æ•°

| å‚æ•°å | å‚æ•°ç±»å‹     | æ˜¯å¦å¿…å¡« | è¯´æ˜       |
| ------ | ------------ | -------- | ---------- |
| ids    | `array<int>` | `true`   | è¯„è®ºIDé›†åˆ |

## 5.4 å“åº”ç¤ºä¾‹

```json
{
    "status": "success",
    "code": 200,
    "msg": "è¯·æ±‚æˆåŠŸ",
    "data": null
}
```

## 5.5 æ¥å£å®ç°

è€ƒè™‘åˆ°éå†åˆ é™¤çš„æ€§èƒ½é—®é¢˜ï¼Œè¿™é‡Œé‡‡ç”¨æ‰¹é‡å¤„ç†çš„æ–¹å¼ï¼Œåˆ é™¤åå‡å°‘å¯¹åº”æ–‡ç« çš„è¯„è®ºæ•°é‡ã€‚

æ€è·¯ï¼š

- æ‰¹é‡æŸ¥è¯¢è¯„è®ºã€‚
- ç­›é€‰å‡ºå¾…åˆ é™¤è¯„è®ºï¼Œæ‰¹é‡åˆ é™¤ã€‚
- ç»Ÿè®¡æ¯ä¸ªæ–‡ç« çš„è¯„è®ºå‡å°‘é‡ï¼Œéå†æ›´æ–°

åœ¨`CommentController`ä¸­å£°æ˜åˆ é™¤æ¥å£`delComments`ï¼š

```java
/**
     * æ‰¹é‡åˆ é™¤è¯„è®ºæ¥å£
     *
     * @param ids
     * @return
     */
    @DeleteMapping("/{ids}")
    @AccessControl(loginRequired = true)
    public Result<Void> delComments(@PathVariable @Validation List<Integer> ids) {
        commentService.delComments(ids);
        return Result.success();
    }
```

è°ƒç”¨ä¸šåŠ¡å±‚åˆ é™¤æ–¹æ³•ï¼Œåœ¨ä¸šåŠ¡å±‚æ–°å¢æ­¤æ–¹æ³•ï¼š

```java
/**
     * åˆ é™¤è¯„è®º
     *
     * @param ids
     */
    void delComments(List<Integer> ids);
```

å®ç°ï¼š

```java
@Override
    @Transactional(rollbackFor = Exception.class)
    public void delComments(List<Integer> ids) {
        List<Comment> comments = findByIds(ids);
        if (CollectionUtils.isEmpty(comments)) {
            return;
        }

        // 1ã€2çº§è¯„è®ºidé›†åˆ
        List<Integer> l1Ids = new ArrayList<>();
        List<Integer> l2Ids = new ArrayList<>();

        // è¯„è®ºæ•°çš„å‡å°‘é‡
        Map<String, Integer> commentDecCountMap = new HashMap<>();

        // ç­›é€‰å‡ºå¾…åˆ é™¤è¯„è®ºid
        comments.forEach(comment -> {
            if (comment == null || comment.getStatus().equals(TargetStatusEnum.DELETED.getStatus())) {
                return;
            }

            Integer cid = comment.getpCommentId();
            boolean isL1 = cid.equals(0);
            if (isL1) {
                l1Ids.add(cid);
            } else {
                l2Ids.add(cid);
            }

            // ç»Ÿè®¡å¯¹åº”æ–‡ç« idè¯„è®ºçš„å‡å°‘é‡
            int dec = isL1 ? commentMapper.countComments(cid) : 1;
            commentDecCountMap.merge(comment.getArticleId(), -dec, Integer::sum);
        });

        // æ‰¹é‡åˆ é™¤1çº§è¯„è®º
        if (!CollectionUtils.isEmpty(l1Ids)) {
            commentMapper.updateToDeleteL1(l1Ids);
        }

        // æ‰¹é‡åˆ é™¤2çº§è¯„è®º
        if (!CollectionUtils.isEmpty(l2Ids)) {
            commentMapper.updateToDeleteL2(l2Ids);
        }

        // å‡å°‘æ–‡ç« è¯„è®ºæ•°é‡
        commentDecCountMap.forEach(articleMapper::updateCommentCount);
    }
```

æ³¨æ„ï¼Œåˆ é™¤1çº§è¯„è®ºæ—¶éœ€è¦åŒæ—¶åˆ é™¤å…¶å­è¯„è®ºï¼Œå› æ­¤åˆ é™¤1ã€2çº§è¯„è®ºåˆ†ä¸ºä¸¤ä¸ªSQLï¼š

```xml
<!-- æ‰¹é‡åˆ é™¤1çº§è¯„è®º -->
<update id="updateToDeleteL1">
    update comment
    set status = 0 where comment_id in
    <foreach collection="ids" item="id" separator="," open="(" close=")">
        #{id}
    </foreach>
    or p_comment_id in
    <foreach collection="ids" item="id" separator="," open="(" close=")">
        #{id}
    </foreach>
</update>

<!-- æ‰¹é‡åˆ é™¤2çº§è¯„è®º -->
<update id="updateToDeleteL2">
    update comment
    set status = 0 where comment_id in
    <foreach collection="ids" item="id" separator="," open="(" close=")">
        #{id}
    </foreach>
</update>
```

åœ¨ç­›é€‰1ã€2çº§è¯„è®ºçš„åŒæ—¶ï¼Œç»Ÿè®¡æ¯ä¸ªæ–‡ç« çš„è¯„è®ºå‡å°‘é‡ï¼Œä»¥ä¾¿åç»­éå†æ›´æ–°ã€‚ç»Ÿè®¡çš„SQLå¦‚ä¸‹ï¼š

```xml
<!-- è®¡æ•°è¯„è®ºæ•°é‡ -->
<select id="countComments" resultType="java.lang.Integer">
    select count(0) total
    from comment
    where comment_id = #{commentId}
       or p_comment_id = #{commentId}
</select>
```

å…³äº`merge()`ï¼š

è¯¥æ–¹æ³•ä¸º`Map`æ¥å£çš„æ–¹æ³•ï¼Œç”¨äº **æ›´æ–°** æˆ– **åˆå¹¶** Map ä¸­çš„é”®å€¼å¯¹ã€‚

å·¥ä½œåŸç†ï¼š

- å¦‚æœ **key** ä¸å­˜åœ¨äº `Map` ä¸­ï¼Œ`merge()` ä¼šå°† `key` å’Œ `value` æ·»åŠ åˆ° `Map` ä¸­ã€‚
- å¦‚æœ **key** å·²ç»å­˜åœ¨ï¼Œ`merge()` ä¼šè°ƒç”¨ `remappingFunction` æ¥å†³å®šæ–°å€¼ã€‚`remappingFunction` æ¥å—å½“å‰å€¼å’Œæ–°å€¼ï¼Œå¹¶è¿”å›åˆå¹¶åçš„æ–°å€¼ã€‚

åœ¨å½“å‰åœºæ™¯ä¸­ï¼Œåˆ©ç”¨`remappingFunction`ä½œå‡å°‘é‡çš„ç´¯åŠ æ“ä½œï¼Œä»è€Œç»Ÿè®¡æ€»å‡å°‘é‡ã€‚

### 5.5.1 ä¼˜åŒ–

å½“å‰åˆ é™¤è¯„è®ºçš„é€»è¾‘æ˜¯å°†ä¸€çº§è¯„è®ºå’ŒäºŒçº§è¯„è®ºåˆ†åˆ«åˆ é™¤ï¼Œä¸»è¦æ˜¯å› ä¸ºåˆ é™¤ä¸€çº§è¯„è®ºæ—¶éœ€è¦åŒæ—¶åˆ é™¤å…¶ä¸‹çº§è¯„è®ºã€‚ä½†å®é™…ä¸Šï¼Œè¿™ä¸¤ä¸ªæ“ä½œå¯ä»¥åˆå¹¶ä¸ºä¸€æ¡ SQL å®ç°ã€‚

```SQL
update comment
set status = 0
where comment_id in (...) or p_comment_id in (...)
```

ç„¶è€Œä¸Šè¿° SQL ä½¿ç”¨äº†ä¸¤ä¸ª `IN` æ¡ä»¶å¹¶é€šè¿‡ `OR` è¿æ¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œå½±å“æ€§èƒ½ã€‚

å¯ä»¥å°è¯•å¦ä¸€ç§å†™æ³•ï¼Œåœ¨æ€§èƒ½å…è®¸æ—¶è€ƒè™‘ä½¿ç”¨ï¼š

```SQL
update comment
set status = 0
where comment_id in (
    select comment_id from comment where comment_id in (...) or p_comment_id in (...)
)
```

å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ é™¤ä¸€çº§è¯„è®ºåŠå…¶ä¸‹çº§è¯„è®ºã€‚å› æ­¤ï¼Œä¸å…¶é€šè¿‡ `or` æ¡ä»¶æŸ¥è¯¢çˆ¶ IDï¼Œä¸å¦‚å…ˆæŸ¥å‡ºè¿™äº›è¯„è®ºçš„ IDï¼Œå†ç»Ÿä¸€æŒ‰ ID åˆ é™¤ï¼ŒSQL å¦‚ä¸‹ï¼š

```sql
update comment set status = 0 where comment_id in (...)
```

åŸºäºä¸Šè¿°æ€è·¯ï¼Œæˆ‘ä»¬åœ¨ Java ä¸­å¯¹è¯„è®ºçš„æ‰¹é‡åˆ é™¤é€»è¾‘è¿›è¡Œäº†è°ƒæ•´ï¼Œä¼˜åŒ–ç‚¹å¦‚ä¸‹ï¼š

1. å…ˆåŒºåˆ†ä¸€çº§è¯„è®ºå’ŒäºŒçº§è¯„è®ºï¼›
2. æ‰¾å‡ºæ‰€æœ‰ä¸€çº§è¯„è®ºçš„å­è¯„è®ºï¼›
3. æ”¶é›†æ‰€æœ‰å¾…åˆ é™¤çš„è¯„è®º IDï¼›
4. ç»Ÿè®¡å¯¹åº”æ–‡ç« çš„è¯„è®ºå‡å°‘é‡ï¼›
5. ç»Ÿä¸€æ‰§è¡Œåˆ é™¤æ“ä½œå¹¶æ›´æ–°æ–‡ç« è¯„è®ºæ•°ã€‚

å®Œæ•´å®ç°å¦‚ä¸‹ï¼š

```java
@Override
    @Transactional(rollbackFor = Exception.class)
    public void delComments(List<Integer> ids) {
        List<Comment> comments = findByIds(ids);
        if (CollectionUtils.isEmpty(comments)) {
            return;
        }

        List<Comment> l2List = new ArrayList<>();  // 2çº§è¯„è®ºåˆ—è¡¨
        Set<Integer> toDelIds = new HashSet<>(); // å¾…åˆ é™¤idåˆ—è¡¨
        Map<String, Integer> commentDecCountMap = new HashMap<>();  // æ–‡ç« ä¸è¯„è®ºæ•°çš„å‡å°‘é‡

        // åˆ†ç±»å¤„ç†ï¼šä¸€çº§è¯„è®ºç›´æ¥åŠ å…¥å¾…åˆ é™¤åˆ—è¡¨ï¼ŒäºŒçº§è¯„è®ºæš‚å­˜
        comments.forEach(comment -> {
            if (comment == null || comment.getStatus().equals(TargetStatusEnum.DELETED.getStatus())) return;

            Integer id = comment.getCommentId();
            boolean isL1 = comment.getpCommentId().equals(0);

            if (isL1) {
                toDelIds.add(id);   // æ”¶é›†1çº§è¯„è®ºid
                commentDecCountMap.merge(comment.getArticleId(), -1, Integer::sum);  // 1çº§è¯„è®ºæœ¬èº«ä¸º1ä¸ªæ•°é‡
            } else {
                l2List.add(comment);
            }
        });

        // æ— éœ€åˆ é™¤çš„è¯„è®ºï¼Œæå‰ç»“æŸ
        if (CollectionUtils.isEmpty(toDelIds) && CollectionUtils.isEmpty(l2List)) return;

        // æŸ¥å‡ºæ‰€æœ‰ä¸€çº§è¯„è®ºçš„äºŒçº§å­è¯„è®ºï¼Œå¹¶ç»Ÿè®¡åˆ é™¤æ•°é‡
        List<Comment> subComments = commentMapper.selectByPIds(toDelIds);
        subComments.forEach(subC -> {
            if (subC.getStatus().equals(TargetStatusEnum.DELETED.getStatus())) return;  // å­è¯„è®ºå·²åˆ é™¤ï¼Œè·³è¿‡
            toDelIds.add(subC.getCommentId());
            commentDecCountMap.merge(subC.getArticleId(), -1, Integer::sum);
        });

        // å¤„ç†å­¤ç«‹çš„2çº§è¯„è®º
        l2List.forEach(c -> {
            if (toDelIds.add(c.getCommentId())) {
                // ç»Ÿè®¡é1çº§å­è¯„è®ºçš„2çº§è¯„è®ºå¯¹åº”æ–‡ç« è¯„è®ºå‡å°‘é‡
                commentDecCountMap.merge(c.getArticleId(), -1, Integer::sum);
            }
        });

        // æ‰¹é‡åˆ é™¤è¯„è®º
        if (!CollectionUtils.isEmpty(toDelIds)) {
            commentMapper.updateToDelete(toDelIds);
            log.info("åˆ é™¤è¯„è®º: {}", toDelIds);
        }

        // å‡å°‘æ–‡ç« è¯„è®ºæ•°é‡
        commentDecCountMap.forEach(articleMapper::updateCommentCount);
    }
```

åœ¨éå†è¯„è®ºåˆ—è¡¨æ—¶ï¼Œä¸ºä»€ä¹ˆè¦å°†äºŒçº§è¯„è®ºå•ç‹¬æ”¶é›†ï¼Œè€Œä¸æ˜¯åœ¨åˆå§‹éå†ä¸­ç›´æ¥å¤„ç†ï¼Ÿ

å¦‚æœåœ¨éå†æ—¶ç›´æ¥åˆ¤æ–­æŸæ¡äºŒçº§è¯„è®ºæ˜¯å¦"å­¤ç«‹"ï¼Œé€šå¸¸ä¼šé€šè¿‡åˆ¤æ–­å…¶çˆ¶è¯„è®º ID æ˜¯å¦å·²åœ¨å¾…åˆ é™¤åˆ—è¡¨ä¸­æ¥åˆ¤æ–­ã€‚ä½†æ­¤æ—¶ç”±äºè¯„è®ºåˆ—è¡¨æ˜¯é¡ºåºéå†çš„ï¼Œ**æŸäº›äºŒçº§è¯„è®ºçš„çˆ¶è¯„è®ºå¯èƒ½å°šæœªéå†åˆ°ï¼ˆå³çˆ¶è¯„è®ºä½äºåˆ—è¡¨åé¢ï¼‰**ï¼Œä»è€Œå¯¼è‡´å½“å‰äºŒçº§è¯„è®ºè¢«**è¯¯åˆ¤ä¸ºå­¤ç«‹è¯„è®º**ï¼Œæå‰è®¡å…¥åˆ é™¤ç»Ÿè®¡ã€‚

è¿™ç§è¯¯åˆ¤å°†ç›´æ¥å¯¼è‡´å¯¹åº”æ–‡ç« çš„è¯„è®ºæ•°å‡å°‘å€¼è®¡ç®—é”™è¯¯ã€‚

å› æ­¤ï¼Œä¸ºäº†ç¡®ä¿åˆ¤æ–­çš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬åœ¨åˆæ­¥éå†æ—¶åªæ”¶é›†äºŒçº§è¯„è®ºï¼Œå¾…ä¸€çº§è¯„è®ºæ”¶é›†å®Œæˆåï¼Œå†ç»Ÿä¸€åˆ¤æ–­å“ªäº›äºŒçº§è¯„è®ºç¡®å®æ˜¯"å­¤ç«‹"çš„ï¼Œå†è¿›è¡Œå¤„ç†ã€‚

